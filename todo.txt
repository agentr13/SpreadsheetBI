TODO
--------

 - Continue working on Sub CreateBiSpreadsheet()
  - Need to go back to the ADO approach as visible / non-visible columns are not exposed via VBA (can be seen in the DIMENSION_IS_VISIBLE field of MDSCHEMA_HIERARCHIES)
  - For background see below  (loop through all dmvs and see which ones are active in power pivot)
   - https://social.technet.microsoft.com/wiki/contents/articles/19941.ssas-query-power-pivot-dmvs-with-vba.aspx
     -  power pivot utilities VBA code
     - https://docs.microsoft.com/en-us/analysis-services/instances/use-dynamic-management-views-dmvs-to-monitor-analysis-services?view=asallproducts-allversions
     
    - Any way I can get cube fields to appear as data validation on Report Fields tab --> yes
    

- See ReportList tab.  Reports are run from here.  Link this to Report dependency tab which will then drive refresh


- Power Query Consolidated Files in Folder
    - add functionality to select only first row of data if flag is set (don't want to return empty tables as will throw errors in power pivot lookup tables).   Pick up first row of first file only, don't expand all files
    - maybe first create the functionality to do this on a single file?



 - Continue to work on generating TestReport
        - Set properties of pivot table


 - Create code to update / overwrite fn_std power queries in this workbook to the active workbook


 - Create generic code to check for items in data tables not in lookup tables using EXCEPT function
 
- create code to generate dax query table on worksheet 

  - Create code for DAX query link back table in seperate file to avoid bloating working model file --> don't think it will be that practical putting in a seperate file but potentially could be better codified.
  
  - - Create code to set up a model sheet (containing all the required tables e.g. Paramaters, ReportFields, ReportDependencies) - most probably a lot easier to just save as a template somewhere but then I cannot generalise onto github.  Most probably lower priority
  
  
  In the date table - is there an issue with using list.dates - see comment from Ken Puls here
  https://blog.crossjoin.co.uk/2016/06/03/creating-tables-in-power-bipower-query-m-code-using-table/