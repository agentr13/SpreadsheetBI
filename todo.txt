TODO
--------

 - Data validation on report field settings is somehow corrupting the listobject
   (i) Maybe divert a bit and create subs to list measures --> done
   (ii) create sub to list columms (put in the same sub as above but list on a seperate sheet--> first create in "create spreadsheet BI") -> Done
   (iii) First create sheets and tables for above ---> Done
   (iv) Write the visible items to a data validation sheet 
        - maybe better option than the below steps is to write directely to validation sheet from the recordset at the same time I am populating the measures and column sheeets
        - filter on visible in columns and measures
        - copy range.SpecialCells(xlVisible).Copy
        - paste onto validation sheet and update the named range on the validation sheet based on the number of visible cellls
   (v) On reportfield settings list first choose measure versus column  -> use cascading validation once measure or column is chosen as to type of orientation etc
   (vi) I have been testing on SpreadsheetBI -> test all of the above on the automatically generated spreadsheet
   
 - Create a sub to list calculated columns (and their formulas -refer power pivot utilities for guidance)

 -  Create ability to format DAX (see power pivot utilities add in)
 
 - Continue to work on generating EntryPoints\GenerateReport
        - Set properties of pivot table (see empty CustomisePivotTable Sub)
        - set pivot field number format
        - Only allow measure on data and vice versa

  - ReportsField tab --> Do not allow columns as data orientation (they would need some sort of sum or someting anyway and this generates VBA error).  Better practice to have measure as data anyway.
     - Conditional formatting on the error formula already created
     - run check before running macro


 - Check if setup is correct before generating reports


- Power Query Consolidated Files in Folder
    - add functionality to select only first row of data if flag is set (don't want to return empty tables as will throw errors in power pivot lookup tables).   Pick up first row of first file only, don't expand all files
    - maybe first create the functionality to do this on a single file?






 - Create code to update / overwrite fn_std power queries in this workbook to the active workbook


 - Create generic code to check for items in data tables not in lookup tables using EXCEPT function
 
- create code to generate dax query table on worksheet 

  - Create code for DAX query link back table in seperate file to avoid bloating working model file --> don't think it will be that practical putting in a seperate file but potentially could be better codified.
  
  - - Create code to set up a model sheet (containing all the required tables e.g. Paramaters, ReportFields, ReportDependencies) - most probably a lot easier to just save as a template somewhere but then I cannot generalise onto github.  Most probably lower priority
  
  
  In the date table - is there an issue with using list.dates - see comment from Ken Puls here
  https://blog.crossjoin.co.uk/2016/06/03/creating-tables-in-power-bipower-query-m-code-using-table/